FROM quay.io/redhat-user-workloads/assisted-installer-tenant/assisted-chat-rag:latest AS rag
# vim: set filetype=dockerfile
# This is the digest of quay.io/lightspeed-core/lightspeed-stack:0.3.0
FROM quay.io/lightspeed-core/lightspeed-stack@sha256:d1805df92f4de55d662e6274328830e2c1300f308c258abfcfad825a241cb50d


COPY migrate.py /app/migrate.py
COPY --chmod=755 --chown=1001:1001 scripts/entrypoint.sh entrypoint.sh
COPY --from=rag /app/all-mpnet-base-v2/ /app-root/all-mpnet-base-v2/
COPY --from=rag /app/llama_stack_vector_db/ /app-root/llama_stack_vector_db/
ENTRYPOINT ["entrypoint.sh"]


USER 1001

EXPOSE 8080
